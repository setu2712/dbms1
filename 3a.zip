CREATE TABLE ACTOR5 (
ACT_ID INTEGER PRIMARY KEY,
ACT_NAME VARCHAR (20),
ACT_GENDER CHAR (1));


CREATE TABLE DIRECTOR5 (
DIR_ID INTEGER PRIMARY KEY,
DIR_NAME VARCHAR (20),
DIR_PHONE NUMBER(20));


CREATE TABLE MOVIES5 (
MOV_ID INTEGER PRIMARY KEY,
MOV_TITLE VARCHAR (50),
MOV_YEAR INTEGER ,
MOV_LANG VARCHAR (20),
DIR_ID INTEGER ,
FOREIGN KEY (DIR_ID) REFERENCES DIRECTOR5(DIR_ID));


CREATE TABLE MOVIES_CAST5 (
ACT_ID INTEGER,
MOV_ID INTEGER,
ROLE VARCHAR (20),
PRIMARY KEY (ACT_ID, MOV_ID),
FOREIGN KEY (ACT_ID) REFERENCES ACTOR5 (ACT_ID),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES5 (MOV_ID));

CREATE TABLE RATING5 (
MOV_ID INTEGER PRIMARY KEY,
REV_STARS VARCHAR (25),
FOREIGN KEY (MOV_ID) REFERENCES MOVIES5 (MOV_ID));




INSERT INTO ACTOR5 VALUES (1,’MADHURI DIXIT’,'F');
INSERT INTO ACTOR5 VALUES (2,’AAMIR KHAN’,’M’);
INSERT INTO ACTOR5 VALUES(3,’JUHI CHAWLA’,’F’);
INSERT INTO ACTOR5 VALUES(4,’SRIDEVI’,’F’);


INSERT INTO DIRECTOR5 VALUES(102,'ALAN TAYLOR',9971960035);
INSERT INTO DIRECTOR5 VALUES(104,’IMTIAZ ALI’, 9845045878);
 INSERT INTO DIRECTOR5 VALUES (105,'HITCHCOCK',7766138911); 
 INSERT INTO DIRECTOR5 VALUES (106,'STEVEN SPIELBERG',9966138934);
INSERT INTO DIRECTOR5 VALUES(100,’SUBHASH KAPOOR’,9563400156);
INSERT INTO DIRECTOR5 VALUES(103,’SANTHOSH ANANDRAM’,993461125);


INSERT INTO MOVIES5 VALUES (501,'JAB HARRY MET SEJAL',2017,'HINDI',104);
INSERT INTO MOVIES5 VALUES (502,'RAJAKUMARA',2017,'KANNADA',103);
INSERT INTo MOVIES5 VALUES (503,'JOLLY LLB 2', 2013,'HINDI', 100);
INSERT INTO MOVIES5 VALUES (504,'TERMINATOR GENESYS',2015,'ENGLISH',102);
INSERT INTO MOVIES5 VALUES (505,'JAWS',1975,'ENGLISH',106);
INSERT INTO MOVIES5 VALUES (506,'BRIDGE OF SPIES',2015,'ENGLISH', 106);
INSERT INTO MOVIES5 VALUES (507,'VERTIGO',1943,'ENGLISH',105);
INSERT INTO MOVIES5 VALUES (508,'SHADOW OF A DOUBT',1943,'ENGLISH',105);


INSERT INTO MOVIES_CAST5 VALUES (1, 501,'HEROINE');
INSERT INTO MOVIES_CAST5 VALUES (1, 502,'HEROINE');
INSERT INTO MOVIES_CAST5 VALUES (3, 503,'COMEDIAN');
INSERT INTO MOVIES_CAST5 VALUES (4, 504,'GUEST');
INSERT INTO MOVIES_CAST5 VALUES (4, 501,'HERO');


INSERT INTO RATING5 VALUES (501, 4);
INSERT INTO RATING5 VALUES (502, 2);
INSERT INTO RATING5 VALUES (503, 5);
INSERT INTO RATING5 VALUES (504, 4);
INSERT INTO RATING5 VALUES (505, 3);
INSERT INTO RATING5 VALUES (506, 2);

SELECT MOV_TITLE FROM MOVIES5 M, DIRECTOR5 D WHERE M.DIR_ID=D.DIR_ID
AND DIR_NAME='HITCHCOCK';



SELECT MOV_TITLE FROM MOVIES5 M,MOVIES_CAST5 MV
WHERE M.MOV_ID=MV.MOV_ID AND ACT_ID IN(SELECT ACT_ID FROM
MOVIES_CAST5 GROUP BY ACT_ID HAVING COUNT(ACT_ID)>1) GROUP BY
MOV_TITLE HAVING COUNT(*)>1;


SELECT ACT_NAME, MOV_TITLE, MOV_YEAR FROM ACTOR5 A JOIN
MOVIES_CAST5 C ON A.ACT_ID=C.ACT_ID INNER JOIN MOVIES5 M
ON C.MOV_ID=M.MOV_ID WHERE M.MOV_YEAR NOT BETWEEN 2000 AND 2015;


SELECT MOV_TITLE,MAX(REV_STARS) FROM MOVIES5 M ,RATING5 R WHERE
M.MOV_ID=R.MOV_ID GROUP BY MOV_TITLE HAVING MAX(REV_STARS)>0 ORDER
BY MOV_TITLE;

UPDATE RATING5 SET REV_STARS=5 WHERE MOV_ID IN(SELECT MOV_ID FROM
MOVIES5 WHERE DIR_ID IN(SELECT DIR_ID FROM DIRECTOR5
WHERE DIR_NAME='STEVEN SPIELBERG'));
SELECT*FROM RATING5;
